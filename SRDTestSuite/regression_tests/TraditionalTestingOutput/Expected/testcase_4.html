


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<meta name="robots" content="index, follow" />
	<meta name="revisit-after" content="1 days" />
		<title>SAMATE Reference Dataset  :: TestCase 4 </title>

	<script type='text/javascript' src='js/design.js'></script>
	<script type='text/javascript' src='js/utils.js' ></script>

	<!--[if IE 6]>
	<script type='text/javascript' src='js/ie6.js'></script>
	<![endif]-->

	<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
	</script>
	<script type="text/javascript">
	_uacct = "UA-437942-2";
	urchinTracker();
	</script>

	<link href='css/style-samate.css' rel='stylesheet' type='text/css' />
				  <!--link rel="alternate" type="application/rss+xml" title="RSS 2.0 for the Samate Reference Dataset" href="http://samate.nist.gov/SRD/rss.php" /-->

</head>
	<body>	<div id='msg-container'>
							</div>	

	<!-- Main menu -->

	<div id='top'>
		<map id="logoMap" name="logoMap">
		<area href="http://samate.nist.gov" title="SAMATE Website" coords="2,2,85,100" alt="SAMATE Logo"/>
		<area href="http://nist.gov" title="National Institute of Standards and Technology" coords="95,15,225,65" alt="NIST Logo"/>
		</map>
		<img usemap="#logoMap" class='left' src='images/dhs/samate_left.png' alt='The SAMATE Project' />
		<a href='http://www.dhs.gov' title='Department of Homeland Security' ><img class='right' src='images/dhs/dhs_right_simple.png' alt='Department of Homeland Security' /></a>
	</div>
	<div id="menu">
	<ul>
		<li ><a href="index.php" title="Home">SRD Home</a></li>
		<li ><a href="view.php" title="View and download the test cases">View / Download</a></li>
		<li ><a href="search.php" title="Search in the test cases repository">Search / Download</a></li>
		<li ><a href="around.php" title="More Downloads: General information, etc.">More Downloads</a></li>
				<li ><a href='testsuite.php?login=Guest' title='Test Suite Manager'>Test Suites</a></li>
	</ul>
	</div>

	<!-- /Menu -->
		<script type='text/javascript'>var tID = "4"; var name="Guest";</script>
	

	<div id="content">
	<div>
		<span class='menu-top-right'>
			Downloads:&nbsp;
								<a href="view.php?reference=4&amp;action=zip-selected" title="Download this Test Case #4" rel="nofollow">
					<img src='./images/icons/download_one.png' alt='Download this Test Case #4'/></a>

					</span>
			</div>
		<h1><a href="javascript:history.go(-1)" style="text-decoration: none;"><img style='border:0; padding-right: 15px;'src='images/arrow.gif' alt='Back to the previous page...' />Back to the previous page</a></h1>
			<!-- 'TestCaseID','Flawed','Author','Associated test case', 'FullName','Language','TypeofTestCase','Ref','SubmissionDate','Description','FileName' -->
			<table width='100%' border='0' cellspacing='0' cellpadding='0'>
				    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Test Case ID</td><td style='background-color:#f7f7f7; font-weight: normal;font-size:14px;'><a href='http://samate.nist.gov/SRD_Manual_TC_Status.html#Candidate_Test_Cases' ><img src='images/Candidate.gif' style='float: right; border:0; margin-left: 20px;' alt='Candidate' title='Status: Candidate' /></a><span>4</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold; width:25%;'><strong><acronym title="Bad: A test case with one or more flaws Good: A test case without known flaws."> Bad / Good / Mixed</acronym></strong></td><td style='background-color:#f9e4e4; text-align: justify; font-weight: normal;'>Bad<a href='http://samate.nist.gov/SRD_Manual_TC_Status.html#Accepted_Test_Cases' ><img src='images/icons/bad.png' style="float: right;" alt='Bad test case' title='Bad test case' /></a></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Author</td><td style='background-color:#f7f7f7; font-weight: normal;'><span>SecureSoftware</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Associated test case</td><td style='background-color:#f7f7f7; text-align: justify; font-weight: normal;'><span  > N/A </span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Contributor</td><td style='background-color:#f7f7f7; font-weight: normal;'><span>SecureSoftware</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Language</td><td style='background-color:#f7f7f7; text-align: justify; font-weight: normal;'><span>C</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Type of test case</td><td style='background-color:#f7f7f7; font-weight: normal;'><span>Source Code</span></td></tr>
	    			    		<tr><td style='display:none'></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold; width:25%;'><strong><acronym title="Input data that reveals the vulnerability">Input string</acronym></strong></td><td style='background-color:#f7f7f7; font-weight: normal;'><span>N/A</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold; width:25%;'><strong><acronym title="Expected outcome of the execution of the test case">Expected Output</acronym></strong></td><td style='background-color:#f7f7f7; font-weight: normal;'><span>The last character in shortString is: l 6c</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold; width:25%;'><strong><acronym title="Instructions for compiling, linkage, and execution of the test case">Instructions</acronym></strong></td><td style='background-color:#f7f7f7; font-weight: normal;'><span>N/A</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Submission date</td><td style='background-color:#f7f7f7; font-weight: normal;'><span>2005-10-21</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Description</td><td style='background-color:#f7f7f7; font-weight: normal;'><span>Miscalculated null termination occurs when the placement of a null character at
the end of a buffer of characters (or string) is misplaced or omitted. (from TCCLASP-5_2_14_9)</span></td></tr>
	    			    		<tr><td class='bg' style='text-align: center; font-weight: bold;  width:25%;'>Filename</td><td style='background-color:#f7f7f7; text-align: justify; font-weight: normal;'><ul class='bullet'><li>&nbsp; <a href='testcases/000/000/004/Miscalculated_null_termination.c'>Miscalculated_null_termination.c</a> (468 bytes)</li></ul></td></tr>
	    		
	    				    		<tr>
						<td class='bg' style='text-align: center; font-weight: bold; width:25%;' >Flaw</td>
						<td style='background-color:#f7f7f7; text-align: justify; font-weight: normal;'>
						
	    								<ul class='bullet'>
											<li> <!--START LI--><a href='javascript:void(0)' onclick="showhide('flaw_0'); return false" title="Show the path in the tree"><img src="images/codelib.gif" alt='(?)' /></a>&nbsp;<span  style='color:#F74552' onclick="show('uniqFlawName')">CWE-170: Improper Null Termination</span>&nbsp;at line <span id='uniqLine' class='4' >6</span><div id='flaw_0' class='flawInfo' style='display: none'>+ Root<br /><img src='images/treenode.gif' alt='>' /> CWE-019: Data Handling<br /> &nbsp;&nbsp;&nbsp;<img src='images/treenode.gif' alt='>' /> <span style='color:red'>CWE-170: Improper Null Termination</span><br /> </div><!--</div>--></li><!--END LI-->
										</ul>
	    			
					</td>
				</tr>
							</table>
			<br />

			<div id="comments">
				<span class='showHide'>
									<a href="#" onclick="showhide('nested_comments'); return false;">There is 1 comment</a>
								<em>::</em> <a href="javascript:popUp('post_comment.php?login=Guest&amp;tID=4')">Submit a comment</a>

				</span>
				<br />
								<div id="nested_comments" style='display:none;'>
					<h1>See the comments</h1>
					<!-- nested comments -->
															<div id='comment_169'><div class='commentContainer' style='background-color:#efefef'><span><span class='nbComment'><em><a style='font:small-caps; color: black;' name="1">Comment #1</a></em></span><span class='Title'> <em>::</em> Weakness Name Change</span><span class='Manage'></span></span><div class='Content'>In CWE, Miscalculated Null Termination is deprecated; due to it was a duplicate of Improper Null Termination.  The weakness name of this test case is changed to new name accordingly.</div>Posted by <span class='Author'>Michael Koo</span>	 <em>::</em>  2008-12-31</div></div>
									</div>
							</div>
			<br />
						<div id="code">
								<table width='100%' border='0' cellspacing='0' cellpadding='0'>
					<tr>
						<td class='title' style='background-color: #94BEFF; text-align: center; font-weight: bold;'><a href="#" name="reference" id="reference-to-code"></a>Miscalculated_null_termination.c</td>
					</tr>
			    	<tr>
			    		<td><div class="c" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #339933;">#include &lt;stdio.h&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #339933;">#include &lt;string.h&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #993333;">int</span> main<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #993333;">char</span> longString<span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #ff0000;">&quot;Cellular bananular phone&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #993333;">char</span> shortString<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">16</span><span style="color: #66cc66;">&#93;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal; color: #cc0; background-color: #ffc;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">strncpy<span style="color: #66cc66;">&#40;</span>shortString, longString, <span style="color: #cc66cc;">16</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span style="color: #000066;">printf</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;The last character in shortString is: %c %1$x<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">shortString<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">15</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #b1b100;">return</span> <span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #808080; font-style: italic;">/*</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #808080; font-style: italic;">The above code gives the following output:</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #808080; font-style: italic;">The last character in shortString is: l 6c</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #808080; font-style: italic;">So, the shortString array does not end in a NULL character, even though the</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #808080; font-style: italic;">“safe” string function strncpy() was used.</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;"><span style="color: #808080; font-style: italic;">*/</span><span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;font-size: 110%; color: #000020;">&nbsp;</div></li></ol></div></td>
			    	</tr>
				</table>
											</div>
					<br />
	</div>
<div id="footer">
	<div class='line'>
	  <p>
        <script type="text/javascript">
	function obfuscate_email(mailto) {
		email_start = "" + "s" + "amate";
		if (mailto==1)
			email_start = "mailto:" + email_start;
		email_end = "." + "gov";
		email_middle = "ni" + "st";
		return email_start + String.fromCharCode(64) + email_middle + email_end;
	}
	
	    </script>
	    <span class='fieldName' style="margin-top:0;">
	<em>Contact:&nbsp; <a href="javascript:void(0)" class='external' title="Contact the Samate team" onclick="this.href=obfuscate_email(1);">
	<script type="text/javascript">document.write(obfuscate_email(0));</script>
	<!--<noscript> 	SAMATE Team
	</noscript> -->
	</a></em><br />
	This webpage is <a href="http://validator.w3.org/check/referer" title="XHTML Strict (non AJAX pages)" >XHTML Strict</a>
	 and <a href="http://www.w3.org/WAI/WCAG1AA-Conformance" title="W3C Web accessibility initiative - Accessible AA" >AA</a> compliant. <br />
	Created on January 2006, last update: June 1, 2013, Version: 4.3<br />
	    <!-- a href='rss.php' title='Samate Reference Dataset RSS Feed'><img src='images/icons/rss2.gif' alt='RSS Feed' /></a-->
    </span>
	    <span class='data'>
        <a href="http://www.itl.nist.gov/" title="ITL">Information Technology Laboratory</a>, <a href="http://www.itl.nist.gov/div897/" title="Division 897">Software and Systems Division</a>
        <br/>
        <a href="http://www.nist.gov/public_affairs/privacy.htm" title="PRIVACY/SECURITY ISSUES">PRIVACY/SECURITY ISSUES</a>
        &bull; <a href="http://www.nist.gov/admin/foia/foia.htm" title="FOIA">FOIA</a>
        &bull; <a href="http://www.nist.gov/public_affairs/disclaim.htm" title="Disclaimer">Disclaimer</a>
        &bull; <a href="http://www.usa.gov" title="USA.gov">USA.gov</a>
        <br />
        <a href="http://www.nist.gov" title="National Institute of Standards and Technology">NIST</a> is an agency of the <a href="http://www.doc.gov" title="Department of Commerce">U.S. Commerce Department</a>
      </span></p>
  </div>
</div>
</body>
</html>